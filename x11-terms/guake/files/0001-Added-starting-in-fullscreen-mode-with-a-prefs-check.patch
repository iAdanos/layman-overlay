From b11bfd2499296c55486dad2406e1216a83a68006 Mon Sep 17 00:00:00 2001
From: Dom Sekotill <kodo@gmx.co.uk>
Date: Tue, 27 Sep 2011 11:26:01 +0100
Subject: [PATCH 1/1] Added starting in fullscreen mode with a prefs checkbox.

---
 data/prefs.glade |   14 ++++++++++++++
 src/guake        |    6 +++++-
 src/prefs.py     |    9 +++++++++
 3 files changed, 28 insertions(+), 1 deletions(-)

diff --git a/data/prefs.glade b/data/prefs.glade
index d7b2441..d486210 100644
--- a/data/prefs.glade
+++ b/data/prefs.glade
@@ -337,6 +337,20 @@
                                     <property name="position">2</property>
                                   </packing>
                                 </child>
+                                <child>
+                                  <widget class="GtkCheckButton" id="start_fullscreen">
+                                    <property name="label" translatable="yes">Start fullscreen</property>
+                                    <property name="visible">True</property>
+                                    <property name="can_focus">True</property>
+                                    <property name="receives_default">False</property>
+                                    <property name="events">GDK_POINTER_MOTION_MASK | GDK_POINTER_MOTION_HINT_MASK | GDK_BUTTON_PRESS_MASK | GDK_BUTTON_RELEASE_MASK</property>
+                                    <property name="draw_indicator">True</property>
+                                    <signal name="toggled" handler="on_start_fullscreen_toggled"/>
+                                  </widget>
+                                  <packing>
+                                    <property name="position">3</property>
+                                  </packing>
+                                </child>
                               </widget>
                             </child>
                           </widget>
diff --git a/src/guake b/src/guake
index 33ad7fd..44d7248 100644
--- a/src/guake
+++ b/src/guake
@@ -576,7 +576,11 @@ class Guake(SimpleGladeApp):
         self.selected_tab = None
 
         # holds fullscreen status
-        self.fullscreen = False
+        self.fullscreen = self.client.get_bool(KEY('/general/start_fullscreen'))
+
+        # set fullscreen?
+        if self.fullscreen:
+             self.window.fullscreen()
 
         # holds the timestamp of the losefocus event
         self.losefocus_time = 0
diff --git a/src/prefs.py b/src/prefs.py
index 9b833e4..709d95e 100644
--- a/src/prefs.py
+++ b/src/prefs.py
@@ -172,6 +172,11 @@ class PrefsCallbacks(object):
         """
         self.client.set_bool(KEY('/general/window_tabbar'), chk.get_active())
 
+    def on_start_fullscreen_toggled(self, chk):
+        """Changes the activity of start_fullscreen in gconf
+        """
+        self.client.set_bool(KEY('/general/start_fullscreen'), chk.get_active())
+
     def on_window_height_value_changed(self, hscale):
         """Changes the value of window_height in gconf
         """
@@ -478,6 +483,10 @@ class PrefsDialog(SimpleGladeApp):
         value = self.client.get_bool(KEY('/general/window_tabbar'))
         self.get_widget('window_tabbar').set_active(value)
 
+        # start fullscreen
+        value = self.client.get_bool(KEY('/general/start_fullscreen'))
+        self.get_widget('start_fullscreen').set_active(value)
+
         # scrollbar
         value = self.client.get_bool(KEY('/general/use_scrollbar'))
         self.get_widget('use_scrollbar').set_active(value)
-- 
1.7.4.1

